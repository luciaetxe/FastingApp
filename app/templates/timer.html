{% extends "base.html" %}
{% block title %}Timer{% endblock %}
{% block content %}
    <h1>Fasting On</h1>
    <div class="timer-container">
        <svg class="timer-circle" width="200" height="200" viewBox="0 0 100 100">
            <circle class="base-circle" cx="50" cy="50" r="45" />
            <circle class="progress-circle" cx="50" cy="50" r="45"
                style="stroke-dashoffset: {{ stroke_dashoffset }};" />
            <text x="50" y="40" class="timer-stats" text-anchor="middle">{{ start_time[:5] }}</text>
            <text x="50" y="50" class="timer-stats" font-size="12" text-anchor="middle">{{ remaining_hours | format_time }}</text>
            <text x="50" y="60" class="timer-stats" text-anchor="middle">{{ end_time[:5] }}</text>
        </svg>
        <div class="timer-details">
            <div class="detail-item">
                <label>Start</label>
                <form method="POST" style="display:inline;">
                    <input type="datetime-local" name="start_time" value="{{ start_time[:16] }}" onchange="this.form.submit()">
                </form>
                <a href="#" class="btn edit-btn" onclick="document.querySelector('input[name=start_time]').focus();">Edit</a>
            </div>
            <div class="detail-item">
                <label>Elapsed</label>
                <span>{{ elapsed_hours | format_time }}</span>
            </div>
            <div class="detail-item">
                <label>Target</label>
                <form method="POST" style="display:inline;">
                    <input type="number" name="hours_planned" min="1" max="24" value="{{ hours }}" onchange="this.form.submit()">
                </form>
                <a href="#" class="btn edit-btn" onclick="document.querySelector('input[name=hours_planned]').focus();">Edit</a>
            </div>
            <div class="detail-item">
                <label>Status (optional)</label>
                <form method="POST" style="display:inline;">
                    <input type="text" name="status" value="{{ status if status else '' }}" placeholder="Enter status" onchange="this.form.submit()">
                </form>
            </div>
        </div>
        <form action="{{ url_for('main.complete') }}" method="GET">
            <button type="submit" class="btn end-fast-btn">End Fast</button>
        </form>
    </div>
{% endblock %}